from HoundSploit.searcher.utils.string import str_is_num_version


def get_software_name_and_version_number(word_list):
    software_name = word_list[0]
    for word in word_list[1:]:
        if not str_is_num_version(word):
            software_name = software_name + ' ' + word
        else:
            num_version = word
    return software_name, num_version


def get_software_name_and_version_number_word_lists(word_list):
    numeric_word_list = []
    for word in word_list:
        if word.isnumeric():
            word_list.remove(word)
            numeric_word_list.append(' ' + word)
            numeric_word_list.append('/' + word)
        if word.__contains__('.'):
            word_list.remove(word)
            numeric_word_list.append(' ' + word)
            numeric_word_list.append('/' + word)
    software_name_word_list = word_list
    return software_name_word_list, numeric_word_list


def filter_vulnerability_based_on_version(query_result_set, numeric_word_list):
    final_result_set = []
    for vulnerability in query_result_set:
        for numeric_word in numeric_word_list:
            if str(vulnerability.description).__contains__(numeric_word) and not list(final_result_set).__contains__(vulnerability):
                final_result_set.append(vulnerability)
    return final_result_set